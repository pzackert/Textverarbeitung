{% extends "base.html" %}

{% block title %}{{ project.projekt_name }} - IFB Antragsprüfung{% endblock %}

{% block content %}
<div class="flex h-full flex-col" x-data="{ currentStep: 1 }">
    <!-- Header -->
    <div class="border-b border-gray-200 bg-white px-4 py-5 sm:px-6">
        <div class="-ml-4 -mt-4 flex flex-wrap items-center justify-between sm:flex-nowrap">
            <div class="ml-4 mt-4">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <span class="inline-flex h-12 w-12 items-center justify-center rounded-full bg-gray-500">
                            <span class="text-lg font-medium leading-none text-white">{{ project.antragsteller[:2] }}</span>
                        </span>
                    </div>
                    <div class="ml-4">
                        <h3 class="text-base font-semibold leading-6 text-gray-900">{{ project.projekt_name }}</h3>
                        <p class="text-sm text-gray-500">
                            <span class="font-mono text-xs text-gray-400 mr-2">{{ project.id }}</span>
                            <a href="#">{{ project.antragsteller }}</a>
                            <span class="mx-1 text-gray-400">&middot;</span>
                            <span>{{ project.modul }}</span>
                        </p>
                    </div>
                </div>
            </div>
            <div class="ml-4 mt-4 flex flex-shrink-0">
                <span class="inline-flex items-center rounded-md bg-{{ project.status_color }}-50 px-2 py-1 text-xs font-medium text-{{ project.status_color }}-700 ring-1 ring-inset ring-{{ project.status_color }}-600/20 mr-4">{{ project.status }}</span>
                <button type="button" class="relative inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50">
                    <span>Dokumente</span>
                </button>
                <button type="button" class="ml-3 relative inline-flex items-center rounded-md bg-primary-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-600">
                    <span>Speichern</span>
                </button>
            </div>
        </div>
    </div>

    <div class="flex flex-1 overflow-hidden">
        <!-- Wizard Sidebar -->
        <nav class="w-64 flex-shrink-0 border-r border-gray-200 bg-gray-50 overflow-y-auto" aria-label="Sidebar">
            <div class="space-y-1 p-4">
                <template x-for="(step, index) in ['Formale Erstprüfung', 'Dokumenten-Scan', 'Kriterienauswahl', 'Automatisierte Prüfung', 'Manuelle Nachprüfung', 'Gesamtbewertung', 'Finalisierung']">
                    <a href="#" 
                       @click.prevent="currentStep = index + 1"
                       :class="currentStep === index + 1 ? 'bg-primary-50 text-primary-700 border-primary-600' : 'text-gray-700 hover:bg-gray-100 hover:text-gray-900 border-transparent'"
                       class="group flex items-center border-l-4 px-3 py-2 text-sm font-medium">
                        <span class="truncate" x-text="step"></span>
                    </a>
                </template>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="flex-1 overflow-y-auto bg-white p-8">
            
            <!-- Step 1: Formale Erstprüfung -->
            <div x-show="currentStep === 1">
                <h2 class="text-lg font-medium leading-6 text-gray-900 mb-4">Schritt 1: Formale Erstprüfung</h2>
                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <svg class="h-5 w-5 text-yellow-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path fill-rule="evenodd" d="M8.485 2.495c.673-1.167 2.357-1.167 3.03 0l6.28 10.875c.673 1.167-.17 2.625-1.516 2.625H3.72c-1.347 0-2.189-1.458-1.515-2.625L8.485 2.495zM10 5a.75.75 0 01.75.75v3.5a.75.75 0 01-1.5 0v-3.5A.75.75 0 0110 5zm0 9a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd" />
                            </svg>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-yellow-700">
                                Bitte prüfen Sie die Vollständigkeit der Unterlagen bevor Sie fortfahren.
                            </p>
                        </div>
                    </div>
                </div>
                
                <fieldset>
                    <legend class="sr-only">Checkliste</legend>
                    <div class="space-y-4">
                        <div class="relative flex items-start">
                            <div class="flex h-6 items-center">
                                <input id="check1" name="check1" type="checkbox" class="h-4 w-4 rounded border-gray-300 text-primary-600 focus:ring-primary-600">
                            </div>
                            <div class="ml-3 text-sm leading-6">
                                <label for="check1" class="font-medium text-gray-900">Antrag vollständig ausgefüllt</label>
                                <p class="text-gray-500">Alle Pflichtfelder sind befüllt.</p>
                            </div>
                        </div>
                        <div class="relative flex items-start">
                            <div class="flex h-6 items-center">
                                <input id="check2" name="check2" type="checkbox" class="h-4 w-4 rounded border-gray-300 text-primary-600 focus:ring-primary-600">
                            </div>
                            <div class="ml-3 text-sm leading-6">
                                <label for="check2" class="font-medium text-gray-900">Unterschrift vorhanden</label>
                                <p class="text-gray-500">Rechtsgültige Unterschrift liegt vor.</p>
                            </div>
                        </div>
                         <div class="relative flex items-start">
                            <div class="flex h-6 items-center">
                                <input id="check3" name="check3" type="checkbox" class="h-4 w-4 rounded border-gray-300 text-primary-600 focus:ring-primary-600">
                            </div>
                            <div class="ml-3 text-sm leading-6">
                                <label for="check3" class="font-medium text-gray-900">Anlagen vollständig</label>
                                <p class="text-gray-500">Alle erforderlichen Anlagen sind hochgeladen.</p>
                            </div>
                        </div>
                    </div>
                </fieldset>
            </div>

            <!-- Step 2: Dokumente -->
            <div x-show="currentStep === 2" x-cloak>
                <h2 class="text-lg font-medium leading-6 text-gray-900 mb-4">Schritt 2: Dokumenten-Scan</h2>
                <ul role="list" class="divide-y divide-gray-100 rounded-md border border-gray-200">
                    {% for doc in project.documents %}
                    <li class="flex items-center justify-between py-4 pl-4 pr-5 text-sm leading-6">
                        <div class="flex w-0 flex-1 items-center">
                            <svg class="h-5 w-5 flex-shrink-0 text-gray-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path fill-rule="evenodd" d="M15.621 4.379a3 3 0 00-4.242 0l-7 7a3 3 0 004.241 4.243h.001l.497-.5a.75.75 0 011.064 1.057l-.498.501-.002.002a4.5 4.5 0 01-6.364-6.364l7-7a4.5 4.5 0 016.368 6.36l-3.455 3.553A2.625 2.625 0 119.52 9.52l3.45-3.551a.75.75 0 111.061 1.06l-3.45 3.551a1.125 1.125 0 001.587 1.595l3.454-3.553a3 3 0 000-4.242z" clip-rule="evenodd" />
                            </svg>
                            <div class="ml-4 flex min-w-0 flex-1 gap-2">
                                <span class="truncate font-medium">{{ doc.name }}</span>
                                <span class="flex-shrink-0 text-gray-400">{{ doc.date }}</span>
                            </div>
                        </div>
                        <div class="ml-4 flex-shrink-0">
                            <a href="#" class="font-medium text-primary-600 hover:text-primary-500">Download</a>
                        </div>
                    </li>
                    {% else %}
                    <li class="py-4 pl-4 pr-5 text-sm text-gray-500">Keine Dokumente vorhanden.</li>
                    {% endfor %}
                </ul>
                
                <div class="mt-6">
                    <label class="block text-sm font-medium leading-6 text-gray-900">Dokumente hochladen</label>
                    <div class="mt-2 flex justify-center rounded-lg border border-dashed border-gray-900/25 px-6 py-10">
                        <div class="text-center">
                            <svg class="mx-auto h-12 w-12 text-gray-300" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                <path fill-rule="evenodd" d="M1.5 6a2.25 2.25 0 012.25-2.25h16.5A2.25 2.25 0 0122.5 6v12a2.25 2.25 0 01-2.25 2.25H3.75A2.25 2.25 0 011.5 18V6zM3 16.06V18c0 .414.336.75.75.75h16.5A.75.75 0 0021 18v-1.94l-2.69-2.689a1.5 1.5 0 00-2.12 0l-.88.879.97.97a.75.75 0 11-1.06 1.06l-5.16-5.159a1.5 1.5 0 00-2.12 0L3 16.061zm10.125-7.81a1.125 1.125 0 112.25 0 1.125 1.125 0 01-2.25 0z" clip-rule="evenodd" />
                            </svg>
                            <div class="mt-4 flex text-sm leading-6 text-gray-600">
                                <label for="file-upload" class="relative cursor-pointer rounded-md bg-white font-semibold text-primary-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-primary-600 focus-within:ring-offset-2 hover:text-primary-500">
                                    <span>Datei auswählen</span>
                                    <input id="file-upload" name="file-upload" type="file" class="sr-only">
                                </label>
                                <p class="pl-1">oder hierher ziehen</p>
                            </div>
                            <p class="text-xs leading-5 text-gray-600">PDF, DOCX, XLSX bis zu 10MB</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 4: Automatisierte Prüfung -->
            <div x-show="currentStep === 4" x-cloak>
                <h2 class="text-lg font-medium leading-6 text-gray-900 mb-4">Schritt 4: Automatisierte Prüfung</h2>
                <div class="overflow-hidden shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg">
                    <table class="min-w-full divide-y divide-gray-300">
                        <thead class="bg-gray-50">
                            <tr>
                                <th scope="col" class="py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6">Kriterium</th>
                                <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Kategorie</th>
                                <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Status</th>
                                <th scope="col" class="relative py-3.5 pl-3 pr-4 sm:pr-6">
                                    <span class="sr-only">Details</span>
                                </th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200 bg-white">
                            {% for crit in criteria %}
                            <tr>
                                <td class="whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6">{{ crit.name }}</td>
                                <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">{{ crit.category }}</td>
                                <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">
                                    {% if crit.status == 'erfüllt' %}
                                    <span class="inline-flex items-center rounded-md bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-inset ring-green-600/20">Erfüllt</span>
                                    {% elif crit.status == 'nicht erfüllt' %}
                                    <span class="inline-flex items-center rounded-md bg-red-50 px-2 py-1 text-xs font-medium text-red-700 ring-1 ring-inset ring-red-600/20">Nicht erfüllt</span>
                                    {% else %}
                                    <span class="inline-flex items-center rounded-md bg-gray-50 px-2 py-1 text-xs font-medium text-gray-600 ring-1 ring-inset ring-gray-500/10">Offen</span>
                                    {% endif %}
                                </td>
                                <td class="relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6">
                                    <a href="#" class="text-primary-600 hover:text-primary-900">Details</a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Navigation Buttons -->
            <div class="mt-8 flex justify-between">
                <button type="button" 
                        @click="currentStep > 1 ? currentStep-- : null"
                        :disabled="currentStep === 1"
                        class="rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 disabled:opacity-50">
                    Zurück
                </button>
                <button type="button" 
                        @click="currentStep < 7 ? currentStep++ : null"
                        :disabled="currentStep === 7"
                        class="rounded-md bg-primary-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-600 disabled:opacity-50">
                    Weiter
                </button>
            </div>

        </main>
    </div>
</div>
{% endblock %}
